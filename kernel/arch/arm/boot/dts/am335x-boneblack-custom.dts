/*
 * Custom additions for a Beaglebone board to enable i2c1
 * abd use it with external devices
 */

#include "am335x-boneblack.dts"

#include <dt-bindings/interrupt-controller/irq.h>
#include <dt-bindings/pinctrl/am33xx.h>
#include <dt-bindings/pinctrl/omap.h>

/*
 * BBB: P9.23 external user led
 */
/ {
	leds {
		anisyan_led {
			label = "anisyan_led";
			gpios = <&gpio1 17 GPIO_ACTIVE_HIGH>;
			default-state = "off";
		};
	};
};

/*
 * BBB: P9.17 - I2C1_SCL
 * BBB: P9.18 - I2C1_SDA
 */
&am33xx_pinmux {
	i2c1_pins: pinmux_i2c1_pins {
		pinctrl-single,pins = < /* enable receiver | pullup selected | disable pullup/down resistor */
			AM33XX_IOPAD(AM335X_PIN_SPI0_D1, (1 << 5) | (1 << 4) | (1 << 3) | MUX_MODE2) /* sda */
			AM33XX_IOPAD(AM335X_PIN_SPI0_CS0, (1 << 5) | (1 << 4) | (1 << 3) | MUX_MODE2) /* scl */
		>;
	};
};

/*
 * Enable i2c1 device, because we use it bus for external i2c devices
 */
&i2c1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c1_pins>;

	clock-frequency = <100000>;

	#address-cells = <1>;
	#size-cells = <0>;

	my-rtc-ds3231@68 {
		compatible = "my-custom,my-ds3231";
		reg = <0x68>;
	};

	my-eeprom-at24c32@57 {
		compatible = "my-custom,my-at24c32";
		reg = <0x57>;
	};
};
